<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POJ2 RecommendService Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <link rel="stylesheet" href="./poj2-recommend-service.css">
</head>
<body class="bg-gray-50">
    <div class="container mx-auto py-8">
        <h1 class="text-2xl font-bold text-center mb-8">RecommendService 테스트</h1>
        
        <!-- 기본 테스트 -->
        <div class="mb-12">
            <h2 class="text-lg font-semibold mb-4">1. 기본 독립 모드 테스트</h2>
            <div id="recommend-service-standalone"></div>
        </div>
        
        <!-- ComponentSkinProps 구조 테스트 -->
        <div class="mb-12">
            <h2 class="text-lg font-semibold mb-4">2. ComponentSkinProps 구조 테스트</h2>
            <div id="recommend-service-webbuilder"></div>
        </div>
        
        <!-- 에디터 모드 테스트 -->
        <div class="mb-12">
            <h2 class="text-lg font-semibold mb-4">3. 에디터 모드 테스트</h2>
            <div id="recommend-service-editor"></div>
        </div>
        
        <!-- 빈 데이터 테스트 (DEFAULT_SERVICES 확인용) -->
        <div class="mb-12">
            <h2 class="text-lg font-semibold mb-4">4. 빈 데이터 테스트 (DEFAULT_SERVICES 표시 확인)</h2>
            <div id="recommend-service-empty"></div>
        </div>
    </div>

    <!-- 빌드된 UMD 파일 로드 -->
    <script src="./../../dist/recommend-service/poj2-recommend-service.umd.js"></script>
    
    <script>
        console.log('Poj2RecommendService:', window.Poj2RecommendService);
        
        // 외부 데이터 연결 확인용 테스트 서비스 데이터 (DEFAULT_SERVICES와 다르게 설정)
        const testServices = [
            {
                id: 'external-1',
                title: '🔥 외부 데이터 - 특별혜택',
                iconUrl: 'https://via.placeholder.com/80x80/ff6b6b/ffffff?text=EXT1',
                linkUrl: 'https://google.com',
                alt: '외부 데이터 특별혜택'
            },
            {
                id: 'external-2',
                title: '⭐ 외부 데이터 - 리워드',
                iconUrl: 'https://via.placeholder.com/80x80/4ecdc4/ffffff?text=EXT2',
                linkUrl: 'https://google.com',
                alt: '외부 데이터 리워드'
            },
            {
                id: 'external-3',
                title: '💎 외부 데이터 - 프리미엄',
                iconUrl: 'https://via.placeholder.com/80x80/45b7d1/ffffff?text=EXT3',
                linkUrl: 'https://google.com',
                alt: '외부 데이터 프리미엄'
            },
            {
                id: 'external-4',
                title: '🎁 외부 데이터 - 이벤트',
                iconUrl: 'https://via.placeholder.com/80x80/f9ca24/ffffff?text=EXT4',
                linkUrl: 'https://google.com',
                alt: '외부 데이터 이벤트'
            },
            {
                id: 'external-5',
                title: '🛍️ 외부 데이터 - 쇼핑',
                iconUrl: 'https://via.placeholder.com/80x80/6c5ce7/ffffff?text=EXT5',
                linkUrl: 'https://google.com',
                alt: '외부 데이터 쇼핑'
            }
        ];

        // 1. 기본 독립 모드 테스트
        const root1 = ReactDOM.createRoot(document.getElementById('recommend-service-standalone'));
        root1.render(React.createElement(window.Poj2RecommendService, {
            title: '독립 모드 테스트',
            subtitle: '기본 props로 실행',
            services: testServices
        }));

        // 2. ComponentSkinProps 구조 테스트
        const webbuilderData = {
            id: 'recommend-service-webbuilder-test',
            title: 'ComponentSkinProps 테스트',
            subtitle: '웹빌더 환경 시뮬레이션',
            services: testServices,
            is_logged: true,
            is_not_logged: true,
            hoveredItemId: null,
            componentUniqueId: 'test-unique-id'
        };

        const webbuilderActions = {
            handleServiceClick: (service, e) => {
                console.log('웹빌더 클릭:', service);
                alert(`웹빌더 모드 클릭: ${service.title} -> ${service.linkUrl}`);
            },
            handleServiceHover: (serviceId) => {
                console.log('호버:', serviceId);
                // 실제로 상태를 업데이트하려면 useState 등이 필요하지만 테스트용으로는 콘솔만
            },
            isValidUrl: (url) => {
                return url && url !== '#';
            },
            translate: (text) => {
                return `[번역] ${text}`;
            }
        };

        const webbuilderUtils = {
            t: (key) => `[번역] ${key}`,
            navigate: (path) => {
                console.log('Navigate to:', path);
                alert(`Navigate to: ${path}`);
            },
            formatCurrency: (amount) => `₩${amount.toLocaleString()}`,
            formatDate: (date) => date.toLocaleDateString('ko-KR'),
            getAssetUrl: (path) => `https://cdn.example.com${path}`,
            cx: (...classes) => classes.filter(Boolean).join(' ')
        };

        const webbuilderApp = {
            user: { id: 'test-user', name: 'Test User' },
            company: { id: 'test-company', name: 'Test Company' },
            currentLanguage: 'ko',
            theme: { primaryColor: '#007bff' }
        };

        const root2 = ReactDOM.createRoot(document.getElementById('recommend-service-webbuilder'));
        root2.render(React.createElement(window.Poj2RecommendService, {
            data: webbuilderData,
            actions: webbuilderActions,
            utils: webbuilderUtils,
            app: webbuilderApp,
            mode: 'production',
            options: {}
        }));

        // 3. 에디터 모드 테스트
        const editorData = {
            ...webbuilderData,
            title: '에디터 모드 테스트',
            subtitle: '클릭이 비활성화됨'
        };

        const editorActions = {
            ...webbuilderActions,
            handleServiceClick: (service, e) => {
                console.log('에디터 모드 - 클릭 비활성화:', service);
                // 에디터 모드에서는 실제로 클릭이 동작하지 않아야 함
            }
        };

        const editorProps = {
            isSelected: true,
            onSelect: () => console.log('컴포넌트 선택됨'),
            onEdit: () => console.log('편집 모드 진입'),
            onDelete: () => console.log('컴포넌트 삭제')
        };

        const root3 = ReactDOM.createRoot(document.getElementById('recommend-service-editor'));
        root3.render(React.createElement(window.Poj2RecommendService, {
            data: editorData,
            actions: editorActions,
            utils: webbuilderUtils,
            app: webbuilderApp,
            mode: 'editor',
            editor: editorProps,
            options: {}
        }));

        // 4. 빈 데이터 테스트 (DEFAULT_SERVICES 표시 확인)
        const emptyData = {
            id: 'recommend-service-empty-test',
            title: '빈 데이터 테스트 - DEFAULT_SERVICES 표시',
            subtitle: '외부 데이터 없음',
            services: [], // 빈 배열 - DEFAULT_SERVICES가 표시되어야 함
            is_logged: true,
            is_not_logged: true
        };

        const root4 = ReactDOM.createRoot(document.getElementById('recommend-service-empty'));
        root4.render(React.createElement(window.Poj2RecommendService, {
            data: emptyData,
            actions: webbuilderActions,
            utils: webbuilderUtils,
            app: webbuilderApp,
            mode: 'production',
            options: {}
        }));

        console.log('모든 테스트 컴포넌트가 렌더링되었습니다.');
        console.log('외부 데이터 vs 기본 데이터 비교:');
        console.log('- 1번: 독립 모드 (외부 testServices 5개)');
        console.log('- 2번: 웹빌더 모드 (외부 testServices 5개)'); 
        console.log('- 3번: 에디터 모드 (외부 testServices 5개)');
        console.log('- 4번: 빈 데이터 모드 (DEFAULT_SERVICES 3개 표시되어야 함)');
    </script>
</body>
</html>